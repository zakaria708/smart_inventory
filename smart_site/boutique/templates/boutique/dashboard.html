{% extends "boutique/base.html" %}

{% block title %}Dashboard – Smart Inventory{% endblock %}

{% block content %}
<h1 class="h3 mb-3">Dashboard</h1>
<p class="text-muted mb-4">
    Indicateurs clés calculés à partir des commandes, produits et clients.
</p>

<div class="row g-3 mb-3">
    <div class="col-md-4">
        <div class="card card-shadow h-100">
            <div class="card-body">
                <h2 class="h6 text-muted text-uppercase mb-2">Valeur totale du stock</h2>
                <p class="display-6 mb-0">{{ valeur_stock_totale|floatformat:2 }} DH</p>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card card-shadow h-100">
            <div class="card-body">
                <h2 class="h6 text-muted text-uppercase mb-2">Panier moyen</h2>
                <p class="display-6 mb-0">
                    {% if panier_moyen %}{{ panier_moyen|floatformat:2 }} DH{% else %}–{% endif %}
                </p>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card card-shadow h-100">
            <div class="card-body">
                <h2 class="h6 text-muted text-uppercase mb-2">Nombre de clients actifs</h2>
                <p class="display-6 mb-0">{{ frequence_clients|length }}</p>
            </div>
        </div>
    </div>
</div>

<div class="row g-3">
    <div class="col-md-6">
        <div class="card card-shadow h-100">
            <div class="card-body">
                <h2 class="h6 text-muted text-uppercase mb-3">Chiffre d’affaires par mois</h2>
                {% if ca_par_mois %}
                    <ul class="list-group list-group-flush">
                        {% for mois, montant in ca_par_mois.items %}
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>{{ mois }}</span>
                                <span class="fw-semibold">{{ montant|floatformat:2 }} DH</span>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted mb-0">Pas encore de données de ventes.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card card-shadow h-100">
            <div class="card-body">
                <h2 class="h6 text-muted text-uppercase mb-3">Produits les plus vendus</h2>
                {% if ventes_par_produit %}
                    <ul class="list-group list-group-flush">
                        {% for nom, qte in ventes_par_produit.items %}
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <span>{{ nom }}</span>
                                <span class="badge bg-primary rounded-pill">{{ qte }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted mb-0">Aucune vente enregistrée pour l’instant.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}